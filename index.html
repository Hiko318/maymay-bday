<!DOCTYPE html>
<html lang="en" data-published="true">
<head>
  <meta charset="UTF-8" />
  <title>Happy Birthday, Maymay</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Staatliches&display=swap" rel="stylesheet" />

  <style>
    :root {
      --accent: #f9d36a;
      --card-bg: rgba(10, 3, 25, 0.9);
      --text-main: #ffffff;
      --text-sub: #f3e6ff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top left, #f0286a, #52027c, #120013);
      min-height: 100vh;
      color: white;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: -20%;
      background: conic-gradient(from 120deg, #f0286a, #a312ff, #ff6fb2, #f9d36a, #f0286a);
      opacity: 0.15;
      mix-blend-mode: screen;
      filter: blur(60px);
      animation: spin 30s linear infinite;
      z-index: -9;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    main {
      max-width: 960px;
      margin: auto;
      padding: 20px;
    }

    .screen {
      display: none;
      height: 100vh;
      width: 100%;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .active { display: flex; }

    /* Allow the final main page to scroll like a normal document */
    #main-page { height: auto; min-height: 100vh; }
    #main-page.active { display: block; }
    /* Center the full main page content card */
    #main-page .card { margin: 20px auto; }

    .card {
      width: 90%;
      max-width: 860px;
      padding: 40px;
      background: radial-gradient(circle at top left, rgba(240,40,106,0.35), rgba(9,0,30,0.95));
      border-radius: 28px;
      border: 1px solid rgba(249,211,106,0.4);
      box-shadow: 0 18px 50px rgba(0,0,0,0.7);
      position: relative;
      overflow: hidden;
    }

    .card::before, .card::after {
      content: "";
      position: absolute;
      width: 200px;
      height: 200px;
      border-radius: 30px;
      background: linear-gradient(135deg, rgba(255,100,160,0.6), rgba(100,40,255,0.6));
      filter: blur(5px);
      opacity: 0.35;
      z-index: -1;
    }
    .card::before { top: -70px; right: -50px; }
    .card::after { bottom: -70px; left: -40px; }

    .big-title {
      font-family: "Staatliches";
      font-size: 3rem;
      text-align: center;
      letter-spacing: 0.15em;
      margin-bottom: 10px;
    }

    .btn {
      margin-top: 25px;
      padding: 12px 30px;
      border: none;
      border-radius: 50px;
      background: white;
      color: #1b0424;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s ease;
    }
    .btn:hover {
      transform: scale(1.05);
      background: var(--accent);
    }

    /* Center the Next button in the wrapped card */
    #next-btn {
      display: block;
      margin: 25px auto 0;
    }

    /* SLIDE ANIMATIONS */
    .slide-in { animation: slideIn 0.55s cubic-bezier(0.2,0.6,0.3,1) forwards; }
    .slide-out { animation: slideOut 0.45s cubic-bezier(0.4,0,0.2,1) forwards; }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(40px) scale(0.96) rotate(-2deg);
        filter: blur(6px);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1) rotate(0);
        filter: blur(0);
      }
    }

    @keyframes slideOut {
      from {
        opacity: 1;
        transform: translateY(0) scale(1) rotate(0);
        filter: blur(0);
      }
      to {
        opacity: 0;
        transform: translateY(-40px) scale(0.96) rotate(2deg);
        filter: blur(6px);
      }
    }

    .card-header {
      font-family: "Staatliches";
      font-size: 2.6rem;
      text-align: center;
      margin-bottom: 15px;
    }

    .card-sub {
      font-size: 1rem;
      text-align: center;
      white-space: pre-line;
      color: var(--text-sub);
      line-height: 1.7;
    }

    /* MAIN PAGE */
    .hero-heading {
      font-family: "Staatliches";
      font-size: 3rem;
      text-align: center;
      letter-spacing: 0.15em;
    }
    .hero-sub {
      text-align: center;
      color: var(--text-sub);
      margin: 10px 0;
    }
    .hero-note {
      text-align: center;
      color: var(--accent);
      font-style: italic;
      margin-bottom: 25px;
    }

    .section-title {
      font-weight: bold;
      font-size: 1.3rem;
      margin-top: 25px;
      margin-bottom: 8px;
      position: relative;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }
    .section-title::after {
      content: "";
      width: 80px;
      height: 3px;
      background: var(--accent);
      border-radius: 20px;
      position: absolute;
      left: 0;
      bottom: -6px;
    }

    .letter-body {
      margin-top: 15px;
      color: var(--text-sub);
      line-height: 1.7;
      white-space: pre-line;
    }

    .reasons-list {
      margin-top: 15px;
      list-style: none;
    }
    .reasons-list li {
      margin-left: 18px;
      margin-bottom: 8px;
      position: relative;
      color: var(--text-sub);
    }
    .reasons-list li::before {
      content: "‚ú∂";
      position: absolute;
      left: -18px;
      color: var(--accent);
    }

    .gallery-grid {
      margin-top: 15px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
    }
    .gallery-item {
      position: relative;
      background: rgba(255,255,255,0.05);
      height: 180px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0 12px 30px rgba(0,0,0,0.6);
      transition: 0.2s ease;
      overflow: hidden;
      display: grid;
      place-items: center;
      cursor: pointer;
    }
    .gallery-item:hover {
      transform: scale(1.03);
      border-color: var(--accent);
    }
    .gallery-item img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: inherit;
    }
    .gallery-caption {
      position: relative;
      z-index: 2;
      color: var(--text-sub);
      text-shadow: 0 1px 8px rgba(0,0,0,0.6);
      text-align: center;
      padding: 0 10px;
    }
    .upload-overlay {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, rgba(249,211,106,0.2), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
      z-index: 1;
    }
    .gallery-item:hover .upload-overlay { opacity: 0.15; }
    .hidden-input { display: none; }

    footer {
      text-align: center;
      margin-top: 25px;
      color: var(--text-sub);
    }
  </style>
</head>

<body>
  <main>

    <!-- START SCREEN -->
    <section id="start-screen" class="screen active">
      <div class="card">
        <div class="big-title">HAPPY BIRTHDAY, MAYMAY!!</div>
        <p style="text-align:center; color:#f3e6ff;">Tap to unwrap your year with me.</p>
        <button id="start-btn" class="btn">Start Wrapped</button>
      </div>
    </section>

    <!-- WRAPPED SCREEN -->
    <section id="wrapped-screen" class="screen">
      <div class="card" id="wrapped-card">
        <h1 id="slide-title" class="card-header"></h1>
        <p id="slide-subtitle" class="card-sub"></p>
        <button id="next-btn" class="btn">Next</button>
      </div>
    </section>

    <!-- MAIN PAGE -->
    <section id="main-page" class="screen">
      <div class="card">
        <h1 class="hero-heading">HAPPY BIRTHDAY, MAYMAY üíú</h1>
        <p class="hero-sub">Thank you for being my favorite person in every world, real or imaginary.</p>
        <p class="hero-note">‚ÄúEven in chaos, I‚Äôd still charge forward for you.‚Äù ‚Äî Tony</p>

        <h2 class="section-title">A Little Letter For You</h2>
        <div class="letter-body">
Dear Maymay,

This year, you turned ordinary days into something I always look forward to.
You made my worst moments softer, my best moments brighter, and every little in-between feel like it mattered.

Thank you for your patience, your laughs, your chaos, and your warmth.
Thank you for being my comfort character in real life.

I‚Äôm so proud of you, so grateful for you, and so in love with you.

Happy birthday, my love.
‚Äî Tony
        </div>

        <h2 class="section-title">Reasons I‚Äôm Glad It‚Äôs You</h2>
        <ul class="reasons-list">
          <li>You make even the most exhausting days feel lighter.</li>
          <li>You listen even when I‚Äôm messy.</li>
          <li>You‚Äôre my safest place and my favorite chaos.</li>
          <li>You remind me I‚Äôm worth loving.</li>
          <li>Your existence already makes my world better.</li>
        </ul>

        <h2 class="section-title">Little Snapshots of Us</h2>
        <div class="gallery-grid" id="gallery">
          <figure class="gallery-item" data-index="0" aria-label="Upload photo 1">
            <img src="assets/embedded-0.png" alt="Snapshot 1" />
            <input type="file" accept="image/*" class="hidden-input" id="file-0" />
            <div class="upload-overlay"></div>
            <figcaption class="gallery-caption">Drop a favorite photo here</figcaption>
          </figure>
          <figure class="gallery-item" data-index="1" aria-label="Upload photo 2">
            <img src="assets/embedded-1.png" alt="Snapshot 2" />
            <input type="file" accept="image/*" class="hidden-input" id="file-1" />
            <div class="upload-overlay"></div>
            <figcaption class="gallery-caption">Another memory slot</figcaption>
          </figure>
          <figure class="gallery-item" data-index="2" aria-label="Upload photo 3">
            <img src="assets/embedded-2.png" alt="Snapshot 3" />
            <input type="file" accept="image/*" class="hidden-input" id="file-2" />
            <div class="upload-overlay"></div>
            <figcaption class="gallery-caption">Drop a favorite photo here</figcaption>
          </figure>
          <figure class="gallery-item" data-index="3" aria-label="Upload photo 4">
            <img src="assets/embedded-3.png" alt="Snapshot 4" />
            <input type="file" accept="image/*" class="hidden-input" id="file-3" />
            <div class="upload-overlay"></div>
            <figcaption class="gallery-caption">Another memory slot</figcaption>
          </figure>
        </div>

        <footer>
          <p>From Tony, who would always reroll until it‚Äôs you.</p>
          <button id="replay-btn" class="btn" style="margin-top:15px;">Replay Wrapped</button>
        </footer>
      </div>
    </section>

  </main>

  <script>
    const isPublished = document.documentElement.dataset.published === 'true';

    // Heartfelt, simple Wrapped slides (no jargon, no cringe)
    const slides = [
      { title: "MAYMAY WRAPPED", subtitle: "Just a few things I wanted you to know." },
      { title: "THIS YEAR", subtitle: "You made my days feel lighter in ways you probably didn‚Äôt notice." },
      { title: "THE MOMENTS I TREASURE", subtitle: "The quiet ones.\nThe normal ones.\nThe ones with you." },
      { title: "WHAT YOU GAVE ME", subtitle: "Comfort.\nUnderstanding.\nA place where I could breathe." },
      { title: "WHEN LIFE WAS HEAVY", subtitle: "You stayed.\nAnd that meant more than you know." },
      { title: "WHAT I ADMIRE", subtitle: "Your heart.\nYour strength.\nThe way you keep going even when it‚Äôs hard." },
      { title: "WHAT I FEEL", subtitle: "Grateful.\nLucky.\nProud of you." },
      { title: "ONE SIMPLE TRUTH", subtitle: "Loving you feels calm.\nAnd it feels right." },
      { title: "THANK YOU", subtitle: "For being patient.\nFor being kind.\nFor being you." },
      { title: "HAPPY BIRTHDAY, MAYMAY", subtitle: "I hope this year treats you gently.\nI‚Äôm always here.\n‚Äî Tony" }
    ];

    const startScreen = document.getElementById("start-screen");
    const wrappedScreen = document.getElementById("wrapped-screen");
    const mainPage = document.getElementById("main-page");

    const startBtn = document.getElementById("start-btn");
    const nextBtn = document.getElementById("next-btn");
    const replayBtn = document.getElementById("replay-btn");

    const slideTitle = document.getElementById("slide-title");
    const slideSubtitle = document.getElementById("slide-subtitle");
    const wrappedCard = document.getElementById("wrapped-card");

    let currentSlide = 0;
    let animating = false;

    function showScreen(screen) {
      [startScreen, wrappedScreen, mainPage].forEach(sec => sec.classList.remove("active"));
      screen.classList.add("active");
    }

    function renderSlide() {
      slideTitle.textContent = slides[currentSlide].title;
      slideSubtitle.textContent = slides[currentSlide].subtitle;
      nextBtn.textContent = currentSlide === slides.length - 1 ? "Continue" : "Next";
    }

    function startWrapped() {
      currentSlide = 0;
      renderSlide();
      showScreen(wrappedScreen);

      wrappedCard.classList.remove("slide-out");
      void wrappedCard.offsetWidth;
      wrappedCard.classList.add("slide-in");
    }

    function nextSlide() {
      if (animating) return;
      animating = true;

      wrappedCard.classList.remove("slide-in");
      wrappedCard.classList.add("slide-out");
    }

    wrappedCard.addEventListener("animationend", (e) => {
      if (e.animationName === "slideOut") {
        if (currentSlide < slides.length - 1) {
          currentSlide++;
          renderSlide();

          wrappedCard.classList.remove("slide-out");
          void wrappedCard.offsetWidth;
          wrappedCard.classList.add("slide-in");
          animating = false;
        } else {
          showScreen(mainPage);
          animating = false;
        }
      } else if (e.animationName === "slideIn") {
        wrappedCard.classList.remove("slide-in");
      }
    });

    startBtn.onclick = startWrapped;
    nextBtn.onclick = nextSlide;

    replayBtn.onclick = () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
      startWrapped();
    };

    // --- Uploadable Gallery Logic (disabled in published view) ---
    const galleryItems = Array.from(document.querySelectorAll('.gallery-item'));

    function setGalleryImage(index, dataUrl) {
      const item = galleryItems[index];
      if (!item) return;
      let img = item.querySelector('img');
      if (!img) {
        img = document.createElement('img');
        item.prepend(img);
      }
      img.src = dataUrl;
      localStorage.setItem('galleryImage_' + index, dataUrl);
      const cap = item.querySelector('.gallery-caption');
      if (cap) cap.textContent = '';
    }

    function restoreGallery() {
      galleryItems.forEach((item, idx) => {
        const saved = localStorage.getItem('galleryImage_' + idx);
        if (saved) {
          setGalleryImage(idx, saved);
        } else {
          // Fallback to repo assets so published site shows images
          setGalleryImage(idx, `assets/embedded-${idx}.png`);
        }
      });
    }

    if (!isPublished) {
      galleryItems.forEach((item, idx) => {
        const fileInput = item.querySelector('input[type="file"]');
        item.addEventListener('click', () => fileInput && fileInput.click());
        fileInput && fileInput.addEventListener('change', (e) => {
          const file = e.target.files && e.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = () => setGalleryImage(idx, reader.result);
          reader.readAsDataURL(file);
        });
      });
    }

    restoreGallery();
  </script>
</body>
</html>
